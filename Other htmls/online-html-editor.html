<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online HTML Editor</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Online HTML Editor</h1>
    </header>
    <main>
        <section id="editor-section">
            <h2>HTML Editor</h2>
            <textarea id="html-input" placeholder="Write your HTML here..."></textarea>
            
            <h2>CSS Editor</h2>
            <textarea id="css-input" placeholder="Write your CSS here..."></textarea>
            <label for="css-filename">Rename CSS file:</label>
            <input type="text" id="css-filename" placeholder="style.css">

            <h2>JavaScript Editor</h2>
            <textarea id="js-input" placeholder="Write your JavaScript here..."></textarea>
            <label for="js-filename">Rename JS file:</label>
            <input type="text" id="js-filename" placeholder="script.js">

            <button id="add-more">Add More HTML/CSS/JS</button>
            <button id="download">Download</button>
        </section>
        
        <section id="output-section">
            <h2>Output</h2>
            <iframe id="output" title="Output Preview"></iframe>
        </section>
    </main>

    <script>
        // Save user progress to local storage
        function saveProgress() {
            localStorage.setItem('htmlInput', document.getElementById('html-input').value);
            localStorage.setItem('cssInput', document.getElementById('css-input').value);
            localStorage.setItem('jsInput', document.getElementById('js-input').value);
            localStorage.setItem('cssFilename', document.getElementById('css-filename').value);
            localStorage.setItem('jsFilename', document.getElementById('js-filename').value);
        }

        // Load user progress from local storage
        function loadProgress() {
            document.getElementById('html-input').value = localStorage.getItem('htmlInput') || '';
            document.getElementById('css-input').value = localStorage.getItem('cssInput') || '';
            document.getElementById('js-input').value = localStorage.getItem('jsInput') || '';
            document.getElementById('css-filename').value = localStorage.getItem('cssFilename') || 'style.css';
            document.getElementById('js-filename').value = localStorage.getItem('jsFilename') || 'script.js';
            updateOutput();
        }

        // Update output preview
        function updateOutput() {
            const htmlContent = document.getElementById('html-input').value;
            const cssContent = document.getElementById('css-input').value;
            const jsContent = document.getElementById('js-input').value;

            const outputFrame = document.getElementById('output').contentWindow.document;
            outputFrame.open();
            outputFrame.write(`
                <html>
                <head>
                    <style>${cssContent}</style>
                </head>
                <body>
                    ${htmlContent}
                    <script>${jsContent}</script>
                </body>
                </html>
            `);
            outputFrame.close();
        }

        // Download files
        function downloadFiles() {
            const htmlContent = document.getElementById('html-input').value;
            const cssContent = document.getElementById('css-input').value;
            const jsContent = document.getElementById('js-input').value;

            const cssFilename = document.getElementById('css-filename').value || 'style.css';
            const jsFilename = document.getElementById('js-filename').value || 'script.js';

            const zip = new JSZip();
            zip.file('index.html', htmlContent);

            if (cssContent) {
                zip.file(cssFilename, cssContent);
            }
            if (jsContent) {
                zip.file(jsFilename, jsContent);
            }

            zip.generateAsync({ type: 'blob' }).then(function(content) {
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = 'project.zip';
                link.click();
            });
        }

        document.getElementById('html-input').addEventListener('input', updateOutput);
        document.getElementById('css-input').addEventListener('input', updateOutput);
        document.getElementById('js-input').addEventListener('input', updateOutput);
        document.getElementById('download').addEventListener('click', downloadFiles);
        document.getElementById('add-more').addEventListener('click', function() {
            // Logic to add more HTML/CSS/JS sections can be implemented here
            alert("Functionality to add more sections is not yet implemented.");
        });

        window.addEventListener('beforeunload', saveProgress);
        window.addEventListener('load', loadProgress);
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</body>
</html>
